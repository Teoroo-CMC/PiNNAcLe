# Read Input
units       real
atom_style  full
read_data   init.geo

# NaCl SPCE 
variable        my_step             equal   0.5/1e3  # ps
variable        my_timestep         equal   ${my_step}*1e3  # fs
timestep        ${my_timestep}
bond_style      harmonic
angle_style     harmonic
dihedral_style  none
improper_style  none
pair_style      lj/cut/coul/long 9.8 9.8
pair_modify     mix arithmetic
kspace_style    pppm 1.0e-4
pair_coeff      1 1   0.0000     2.058
pair_coeff      2 2   0.15535    3.166
pair_coeff      3 3   0.3526418  2.1595384928
pair_coeff      4 4   0.0127850  4.8304528498
bond_coeff      1     1000.00    1.000
angle_coeff     1     100.0      109.47
neighbor        3.0 bin

# Simulation setup
variable  my_time_equ         equal   0.1  # ns
variable  my_time_pro         equal   0.1  # ns
variable  my_temp             equal   323  # Kelvin
variable  my_temp_damp        equal   ${my_step}*200  # From CSVR paper
variable  n_steps_equ         equal   ${my_time_equ}/${my_step}*1e3
variable  n_steps_pro         equal   ${my_time_pro}/${my_step}*1e3

# IO setup
variable  my_dump             equal   0.1  # ps
variable  my_thermo           equal   ${my_dump}  # ps
variable  n_thermo            equal   ${my_thermo}/${my_step}
variable  n_dump              equal   ${my_dump}/${my_step}
variable  dump_format         string  "id type x y z fx fy fz"
variable  dump_format_format  string  "'%d %d %.6f %.6f %.6f %.6e %.6e %.6e'"

# Run Simultion
## NVT-CSVR
thermo       ${n_thermo}
variable     is_restart  equal 0
fix          0 all nve
fix          1 all temp/csvr ${my_temp} ${my_temp} ${my_temp_damp} 123
log          equi.log
if           "${is_restart} == 0" then "run ${n_steps_equ}"
dump         2 all custom ${n_dump} prod.dump ${dump_format}
dump_modify  2 sort id
log          prod.log
run          ${n_steps_pro}

# Finalize
write_restart  final.restart
